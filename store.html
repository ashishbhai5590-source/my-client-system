<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§∏‡•ç‡§ü‡•ã‡§∞</title>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        :root{--primary-color:#0d6efd;--success-color:#198754;--danger-color:#dc3545} body{font-family:-apple-system, sans-serif;margin:0;background-color:#f8f9fa}
        /* --- ‡§∏‡§æ‡§∞‡§æ CSS ‡§ï‡•ã‡§° ‡§Ø‡§π‡§æ‡§Å ‡§π‡•à (‡§ï‡•ã‡§à ‡§¨‡§¶‡§≤‡§æ‡§µ ‡§®‡§π‡•Ä‡§Ç) --- */
        .skeleton{animation:pulse 1.5s cubic-bezier(0.4,0,0.6,1) infinite}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}} .skeleton-image{width:100%;height:350px;background-color:#e0e0e0} .skeleton-text{height:20px;width:80%;background-color:#e0e0e0;border-radius:4px;margin:15px} .skeleton-price{height:28px;width:40%;background-color:#e0e0e0;border-radius:4px;margin:15px} .skeleton-box{height:50px;background-color:#e0e0e0;border-radius:8px;margin:15px} .announcement-bar{background:#212529;color:#fff;text-align:center;padding:12px;font-size:15px;font-weight:700} .container{background:#fff;max-width:600px;margin:10px auto;border-radius:15px;box-shadow:0 4px 12px rgba(0,0,0,.1);overflow:hidden} .product-gallery{position:relative} .swiper-container{width:100%;height:350px} .swiper-slide img{width:100%;height:100%;object-fit:cover} .swiper-pagination{position:absolute!important;bottom:10px!important} .swiper-pagination-bullet-active{background:var(--primary-color)!important} .product-details{padding:20px} .product-title{font-size:24px;font-weight:700;margin-top:0} .review-text{color:#6c757d;margin:5px 0 15px} .price-box{display:flex;align-items:center;gap:10px;margin-bottom:15px} .price{font-size:28px;color:var(--success-color);font-weight:700} .old-price{text-decoration:line-through;color:#6c757d} .discount{background-color:#ffe0e0;color:var(--danger-color);padding:3px 8px;border-radius:5px;font-weight:700;font-size:14px} .features-list p{display:flex;align-items:center;gap:8px;margin:8px 0} .features-list i{color:var(--success-color)} .order-box{background:#f8f9fa;padding:20px;border-radius:10px;margin-top:20px} .button{width:100%;padding:15px;border:none;border-radius:8px;color:#fff;font-size:18px;font-weight:700;cursor:pointer} .buy-now-btn{background-color:var(--primary-color);} .footer{text-align:center;padding:20px;font-size:14px} .footer a{color:var(--primary-color);text-decoration:none;margin:0 10px;display:inline-block;margin-bottom:10px} .policy-modal{display:none;position:fixed;z-index:1001;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.5);animation:fadeIn .3s} .policy-modal-content{background-color:#fefefe;margin:auto;padding:25px;border-radius:10px;width:90%;max-width:500px;position:relative;top:50%;transform:translateY(-50%)} .policy-close-btn{color:#aaa;float:right;font-size:28px;font-weight:700;cursor:pointer} .notification{display:none;position:fixed;top:20px;left:50%;transform:translateX(-50%);background-color:var(--success-color);color:white;padding:15px 25px;border-radius:8px;box-shadow:0 4px 15px rgba(0,0,0,.2);z-index:2000;animation:slideIn .3s both} @keyframes slideIn{from{transform:translate(-50%,-100px);opacity:0}to{transform:translate(-50%,0);opacity:1}} @keyframes fadeIn{from{opacity:0}}
        .offer-timer{background:#fff3cd;border-radius:12px;padding:20px;text-align:center;margin:20px 0} .offer-timer h4{margin:0 0 15px;font-size:18px} .countdown{display:flex;justify-content:space-around;gap:8px;text-align:center} .time-box{background:var(--primary-color);color:#fff;padding:10px 5px;border-radius:10px;width:100%} .time-box span{display:block;font-size:28px;font-weight:700} .time-box small{font-size:12px}
        .cod-info { text-align: center; font-weight: 600; color: var(--success-color); background: #eafaf1; padding: 12px; border-radius: 8px; margin-bottom: 15px; }
        #checkout-page { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 1000; overflow-y: auto; animation: slideUp 0.4s ease-out; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .checkout-container { max-width: 600px; margin: auto; padding: 20px; }
        .checkout-header{display:flex;justify-content:space-between;align-items:center;padding-bottom:15px;margin-bottom:20px} .checkout-header h2{margin:0;font-size:20px} .checkout-close-btn{font-size:28px;cursor:pointer;color:#888} .progress-bar{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px; position: relative;} .progress-step{width:30px;height:30px;border-radius:50%;background:#eee;color:#888;display:flex;align-items:center;justify-content:center;font-weight:700;transition:all 0.3s ease; position: relative; z-index: 1;} .progress-step.active{background:var(--primary-color);color:#fff;transform:scale(1.1)} .progress-line{position: absolute; height: 3px; background: #eee; width: calc(100% - 80px); left: 40px; top: 14px;} .progress-line-fill{height: 3px; background: var(--primary-color); width: 0%; transition: width 0.4s ease;} .step-content{display:none;animation:fadeIn 0.4s} .step-content.active{display:block} .step-content input{width:100%;padding:14px;border:1px solid #ced4da;border-radius:8px;font-size:16px;margin-bottom:15px;box-sizing:border-box}
        .checkout-footer { position: fixed; bottom: 0; left: 0; width: 100%; background: #fff; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); padding: 15px; box-sizing: border-box; }
        .checkout-footer .button-group { max-width: 600px; margin: auto; display: flex; justify-content: space-between; }
        .checkout-footer .button{width:48%} .back-btn{background-color:#6c757d}
        .payment-options button{width:100%; margin-bottom:10px; font-size: 16px; padding: 14px;}
        .payment-options .cod-final{background-color: #ffc107; color: #333;}
        .payment-options .online-final{background-color: var(--success-color);}
    </style>
</head>
<body>
    <div id="loading"><div class="announcement-bar skeleton" style="height:40px"></div><div style="margin:10px auto;max-width:600px;background:#fff;border-radius:15px;overflow:hidden"><div class="skeleton-image skeleton"></div><div style="padding:15px"><div class="skeleton-text skeleton"></div><div class="skeleton-text skeleton" style="width:60%"></div><div class="skeleton-price skeleton"></div><div class="skeleton-box skeleton"></div></div></div></div>
    
    <div id="product-page" style="display:none;">
        <div id="announcement-bar" class="announcement-bar"></div><div class="container">
            <div class="product-gallery"><div class="swiper-container"><div class="swiper-wrapper" id="image-slider"></div></div><div class="swiper-pagination"></div></div>
            <div class="product-details">
                <h1 class="product-title" id="product-name"></h1><p class="review-text" id="product-reviews"></p>
                <div class="price-box"><span class="price" id="current-price"></span> <span class="old-price" id="old-price"></span><span class="discount" id="discount"></span></div>
                <div class="offer-timer"><h4>üî• ‡§ë‡§´‡§∞ ‡§∏‡•Ä‡§Æ‡§ø‡§§ ‡§∏‡§Æ‡§Ø ‡§ï‡•á ‡§≤‡§ø‡§è! ‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§ï‡§∞‡•á‡§Ç!</h4><div class="countdown"><div class="time-box"><span id="days">00</span><small>‡§¶‡§ø‡§®</small></div><div class="time-box"><span id="hours">00</span><small>‡§ò‡§Ç‡§ü‡•á</small></div><div class="time-box"><span id="mins">00</span><small>‡§Æ‡§ø‡§®‡§ü</small></div><div class="time-box"><span id="secs">00</span><small>‡§∏‡•á‡§ï‡§Ç‡§°</small></div></div></div>
                <div id="features-list" class="features-list"></div>
                <div class="order-box">
                    <div class="cod-info">‚úÖ ‡§ï‡•à‡§∂ ‡§ë‡§® ‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•à</div>
                    <button type="button" class="button buy-now-btn" id="buy-now-btn">üõí ‡§Ö‡§≠‡•Ä ‡§ñ‡§∞‡•Ä‡§¶‡•á‡§Ç</button>
                </div>
            </div>
        </div>
        <div class="footer" id="footer-links"></div>
    </div>
    
    <div id="checkout-page"></div>
    <div id="policyModal" class="policy-modal"><div class="policy-modal-content"><span class="policy-close-btn" onclick="closePolicyModal()">&times;</span><h2 id="policy-title"></h2><p id="policy-text" style="white-space:pre-wrap;line-height:1.6"></p></div></div>
    <div id="notification" class="notification"></div>
    <audio id="success-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" preload="auto"></audio>
    
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-database.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
        // ============== ‡§Ö‡§™‡§®‡•Ä Firebase Keys ‡§Ø‡§π‡§æ‡§Å ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç ==============
    const firebaseConfig = {
    apiKey: "AIzaSyCZAoe1zoWGZk7A1WLFxdR4T67ntvmFIfY",
    authDomain: "my-client-stores.firebaseapp.com",
    databaseURL: "https://my-client-stores-default-rtdb.firebaseio.com",
    projectId: "my-client-stores",
    storageBucket: "my-client-stores.firebasestorage.app",
    messagingSenderId: "658459339073",
    appId: "1:658459339073:web:37fa1b05e06c09c14119c0",
    measurementId: "G-N8MVEE3B19"
  };
        // ==============================================================

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const params = new URLSearchParams(window.location.search);
        const clientId = params.get('clientId');
        const productId = params.get('productId');
        let productData, clientData, rzp;

        // --- ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ---
        if (clientId && productId) {
            database.ref('clients/' + clientId).once('value', clientSnapshot => {
                if (!clientSnapshot.exists() || clientSnapshot.val().status === 'blocked') {
                    document.getElementById('loading').innerHTML = '<h1 style="text-align:center;padding:50px;">‡§Ø‡§π ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§Ö‡§∏‡•ç‡§•‡§æ‡§Ø‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¨‡§Ç‡§¶ ‡§π‡•à‡•§</h1>';
                    return;
                }
                clientData = clientSnapshot.val();

                database.ref(`products/${clientId}/${productId}`).once('value').then(productSnapshot => {
                    if (!productSnapshot.exists()) {
                        document.getElementById('loading').innerHTML = '<h1 style="text-align:center;padding:50px;">‡§™‡•ç‡§∞‡•ã‡§°‡§ï‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§</h1>';
                        return;
                    }
                    productData = productSnapshot.val();
                    initializePage(productData, clientData);
                });
            });
        } else {
            document.getElementById('loading').innerHTML = '<h1 style="text-align:center;padding:50px;">‡§ó‡§≤‡§§ ‡§≤‡§ø‡§Ç‡§ï‡•§</h1>';
        }
        
        // --- ‡§™‡•á‡§ú ‡§ï‡•ã ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ---
        function initializePage(product, client) {
            document.title=product.name;document.getElementById('product-name').innerText=product.name;document.getElementById('product-reviews').innerText=product.reviewText;document.getElementById('current-price').innerText=`‚Çπ${product.price}`;document.getElementById('old-price').innerText=`‚Çπ${product.oldPrice}`;
            const discount=Math.round(((product.oldPrice-product.price)/product.oldPrice)*100);if(discount>0)document.getElementById('discount').innerText=`${discount}% OFF`; else document.getElementById('discount').style.display='none';
            document.getElementById('image-slider').innerHTML=product.images.map(url=>`<div class="swiper-slide"><img src="${url}" alt="Product Image"></div>`).join('');document.getElementById('features-list').innerHTML=product.features.map(f=>`<p><i class="fa-solid fa-circle-check"></i> ${f}</p>`).join('');document.getElementById('announcement-bar').innerText=product.announcementText || 'üöö ‡§Ü‡§ú ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ ‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä ‡§¨‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§Æ‡•Å‡§´‡§º‡•ç‡§§!';
            const footer=document.getElementById('footer-links');if(product.privacyPolicy)footer.innerHTML+=`<a href="#" onclick="showPolicyModal('Privacy Policy','privacyPolicy')">Privacy Policy</a>`;if(product.refundPolicy)footer.innerHTML+=`<a href="#" onclick="showPolicyModal('Refund Policy','refundPolicy')">Refund Policy</a>`;if(product.aboutUs)footer.innerHTML+=`<a href="#" onclick="showPolicyModal('About Us','aboutUs')">About Us</a>`;if(product.contactUs)footer.innerHTML+=`<a href="#" onclick="showPolicyModal('Contact Us','contactUs')">Contact Us</a>`;footer.innerHTML+=`<br><br><a href="track.html" style="font-weight:bold;">‡§Ö‡§™‡§®‡§æ ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ï‡§∞‡•á‡§Ç üöö</a>`;
            new Swiper('.swiper-container',{loop:true,pagination:{el:'.swiper-pagination',clickable:true}});
            if (client.razorpayKeyId && client.razorpayKeyId.toLowerCase() !== 'cod') {
                rzp = new Razorpay({ key: client.razorpayKeyId, amount: product.price * 100, currency: "INR", name: product.name, handler: function(res){ saveOrder('Online', res.razorpay_payment_id) } });
            } else {
                document.getElementById('online-final-btn') && (document.getElementById('online-final-btn').style.display = 'none');
            }
            const offerEndDate=new Date().getTime()+(2*24*60*60*1000 + 23*60*60*1000); const timerInterval = setInterval(()=>{const d=offerEndDate-new Date().getTime();if(d<0){clearInterval(timerInterval);return;}document.getElementById('days').innerText=Math.floor(d/(1000*60*60*24));document.getElementById('hours').innerText=Math.floor((d%(1000*60*60*24))/(1000*60*60));document.getElementById('mins').innerText=Math.floor((d%(1000*60*60))/(1000*60));document.getElementById('secs').innerText=Math.floor((d%(1000*60))/1000)},1000);
            document.getElementById('loading').style.display='none';document.getElementById('product-page').style.display='block';
        }
        
        function showNotification(message, isSuccess = true) { const n=document.getElementById('notification');n.textContent=message;n.style.backgroundColor=isSuccess?'var(--success-color)':'var(--danger-color)';n.style.display='block';if(isSuccess)document.getElementById('success-sound').play();setTimeout(()=>n.style.display='none',4000); }
        function showPolicyModal(title,key){document.getElementById('policy-title').innerText=title;document.getElementById('policy-text').innerText=productData[key];document.getElementById('policyModal').style.display='block'}
        function closePolicyModal(){document.getElementById('policyModal').style.display='none'}

        // --- ‡§´‡•Å‡§≤-‡§™‡•á‡§ú ‡§ö‡•á‡§ï‡§Ü‡§â‡§ü ‡§ï‡§æ JS ---
        const checkoutPage = document.getElementById('checkout-page');
        checkoutPage.innerHTML = `<div class="checkout-container">...</div>`; // (HTML for checkout page)
        const buyNowBtn=document.getElementById('buy-now-btn');const closeBtn=document.querySelector('.checkout-close-btn');const nextBtn=document.getElementById('nextBtn');const backBtn=document.getElementById('backBtn');const codFinalBtn=document.getElementById('cod-final-btn');const onlineFinalBtn=document.getElementById('online-final-btn');
        let currentStep=1;
        const stepTitles=["‡§∏‡•ç‡§ü‡•á‡§™ 1: ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä","‡§∏‡•ç‡§ü‡•á‡§™ 2: ‡§°‡§ø‡§≤‡§ø‡§µ‡§∞‡•Ä ‡§è‡§°‡•ç‡§∞‡•á‡§∏","‡§∏‡•ç‡§ü‡•á‡§™ 3: ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§ï‡§æ ‡§§‡§∞‡•Ä‡§ï‡§æ"];
        buyNowBtn.addEventListener('click',openCheckout);closeBtn.addEventListener('click',closeCheckout);nextBtn.addEventListener('click',nextStep);backBtn.addEventListener('click',prevStep);codFinalBtn.addEventListener('click',()=>saveOrder('COD'));onlineFinalBtn.addEventListener('click',()=> { if(rzp) rzp.open(); else showNotification('‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§Ö‡§≠‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§', false); });
        function openCheckout(){currentStep=1;updateStepUI();checkoutPage.style.display='block';window.scrollTo(0,0);}
        function closeCheckout(){checkoutPage.style.display='none';}
        function updateStepUI(){/* ... */ } // (UI Update logic from previous code)
        function validateCurrentStep(){/* ... */ } // (Validation logic from previous code)
        function nextStep(){if(!validateCurrentStep())return;if(currentStep<3){currentStep++;updateStepUI()}}
        function prevStep(){if(currentStep>1){currentStep--;updateStepUI()} else {closeCheckout();}}
        
        function saveOrder(type, paymentId = null){
            const phone = document.getElementById('modal-phone').value;
            const orderData = { customer_name: document.getElementById('modal-name').value, customer_address: document.getElementById('modal-address').value, customer_pincode: document.getElementById('modal-pincode').value, customer_phone: phone, productName: productData.name, type, paymentId, status: 'Processing' };
            database.ref(`orders/${clientId}/${productId}/${Date.now()}`).set(orderData);
            database.ref(`tracking/${phone}`).set({status:'Processing'});
            showNotification('‡§ë‡§∞‡•ç‡§°‡§∞ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...', true);
            setTimeout(() => { window.location.href = 'success.html'; }, 1500);
        }
    </script>
</body>
</html>